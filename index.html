<!DOCTYPE html>
<html>
  <head>
  	<script type="text/javascript">
		var remote = require('remote');
      	console.log(remote.require('app').getVersion());
  	</script>
    <title>Hello World!</title>
  </head>
  <body>
    <h1>Hello World!</h1>
    We are using io.js <script>document.write(process.version)</script>
    and Electron <script>document.write(process.versions['electron'])</script>.
    <br/>
    And myapp version is <script>document.write(remote.require('app').getVersion())</script>

  </body>
  <script>
		// In renderer process (web page).
		var fs = remote.require('fs');
    var readChunk = remote.require('read-chunk');
    var fileType = remote.require('file-type');
		var audiofiles = new Array();

    // Get file list
		fs.readdir('/home/binayak/Music', function(err, files){
        if (err == null){
          // console.log(files);
          var nfiles = files.length;
          for (var i = 0; i < nfiles; i++){
            var chunk = readChunk.sync('/home/binayak/Music/' + files[i], 0, 262);
            if(fileType(chunk).mime == 'audio/mpeg'){
              audiofiles.push(files[i]);
            }
            else {
              console.log("Could read folder");
              console.log(err);
            }
          }
        }
    });

    // Play audio files
    var musicForTheEars= null;
    var context, track;
    try{
      window.AudioContext = window.AudioContext || window.webkitAudioContext;
      context = new AudioContext();
    }
    catch(e){
      console.log('Audio API is broken :\'(');
    }
    function loadMusicToPlay(path){
      tarck = null;
      try{
        track = fs.readFileSync(path);
      }
      catch(e){
        console.log('Could not read file: ' + path);
        console.log(e);
      }
    }
    setTimeout(function(){
      loadMusicToPlay('/home/binayak/Music/' + audiofiles[0]);
      context.decodeAudioData(track, function(buffer){
        musicForTheEars = buffer;
      });

      var source = context.createBufferSource();
      source.buffer = musicForTheEars;
      source.connect =(context.destination);
      source.start(0);
    }, 200);

</script>
</html>